# Anti-Func Plugin Documentation

Многофункциональный плагин для WordPress, заменяющий необходимость редактирования файла functions.php. Предоставляет более 30 полезных функций для оптимизации, безопасности и улучшения сайта.

## Основные возможности

- Управление скриптами и стилями
- Кастомизация административной панели
- Система контроля доступа и регистрации
- Оптимизация SEO и метаданных
- Инструменты для работы с пользователями
- Шорткоды для различного функционала
- Система мониторинга посетителей
- Защита от спама и ботов

## Функции плагина

### 1. Управление HLS.js
**Функции:** `my_deregister_hls_script()`, `custom_enqueue_hls()`
- Удаляет стандартный скрипт HLS.js
- Подключает кастомную версию HLS.js для видео-плеера
- Автоматически определяет необходимость подключения по наличию шорткода `[m3u_player]`

### 2. Центрирование контента
**Класс:** `CenterShortcodes`
**Шорткоды:** `[center]`, `[center_block]`
- `[center]` - центрирует контент с помощью flex
- `[center_block width="auto"]` - центрирует блок с возможностью указания ширины

### 3. Отслеживание времени входа пользователей
**Функции:** `record_user_login_time()`
- Сохраняет время последнего и предыдущего входа пользователя
- Хранит данные в user_meta

### 4. Оптимизация и безопасность
**Функции:**
- Удаление ненужных мета-тегов и ссылок (generator, wlwmanifest, rsd, shortlink)
- Отключение emoji скриптов и стилей
- Ленивая загрузка для списков постов
- Кэширование фрагментов с большим количеством DOM
- Очистка просроченных transient

### 5. Блокировка нежелательных регистраций
**Функции:** `get_user_real_ip()`, `prevent_multiple_registrations_from_same_ip()`, `save_user_registration_ip()`, `block_specific_emails()`
- Запрет множественных регистраций с одного IP
- Блокировка специфических email и доменов
- Чтение заблокированных доменов из файла `blocked-domains.txt`

### 6. SEO оптимизация
**Функции:** `addPageNumberToMeta()`, `artabr_remove_name_cat()`
- Добавление номера страницы в метаданные
- Удаление слова "Рубрика" из заголовков архивов

### 7. Управление сессиями
**Функции:** `custom_auth_cookie_expiration()`
- Установка тайм-аута сессии (4 часа для обычных пользователей)
- Увеличение времени сессии для администраторов

### 8. Уникальные мета-описания для пагинации
**Функции:** `remove_default_meta_description()`, `custom_pagination_meta_description()`
- Создание уникальных description для страниц пагинации

## Шорткоды

### 1. `[yellowbox]`
Создает желтый блок с контентом
```html
[yellowbox]Ваш текст здесь[/yellowbox]
```

### 2. `[online_users]`
Отображает таблицу пользователей онлайн в реальном времени
```html
[online_users]
```

### 3. `[visitors_stats]`
Показывает статистику посещений за различные периоды
```html
[visitors_stats]
```

### 4. `[registered_users]`
Выводит список зарегистрированных пользователей
```html
[registered_users]
```

### 5. `[restricted]`
Скрывает контент для незарегистрированных пользователей
```html
[restricted]Приватный контент[/restricted]
```

### 6. `[site_stats]`
Отображает статистику сайта
```html
[site_stats show_posts="true" show_pages="true" show_categories="true" show_tags="true" show_users="true" show_comments="true" show_today_users="true"]
```

**Параметры:**
- `show_posts` - показывать количество записей
- `show_pages` - показывать количество страниц
- `show_categories` - показывать количество рубрик
- `show_tags` - показывать количество меток
- `show_users` - показывать количество пользователей
- `show_comments` - показывать количество комментариев
- `show_today_users` - показывать количество регистраций за сегодня

### 7. `[random_quote]`
Выводит случайную цитату из файла `quotes.txt`
```html
[random_quote]
```

### 8. `[last_update]`
Показывает дату последнего обновления
```html
[last_update]
```

### 9. `[scrolling_list]`
Создает прокручиваемый список с поиском
```html
[scrolling_list items="Элемент 1, Элемент 2, Элемент 3" height="200px"]
```

**Параметры:**
- `items` - список элементов через запятую
- `height` - высота списка

### 10. `[page_load_time]`
Отображает время загрузки страницы
```html
[page_load_time]
```

### 11. `[page_size]`
Показывает размер страницы в KB
```html
[page_size]
```

### 12. `[visitor_info]`
Отображает информацию о посетителе (IP, местоположение, браузер)
```html
[visitor_info]
```

## Дополнительные функции

### Кастомизация страницы входа
- Изменение логотипа на странице входа
- Настройка фонового цвета

### Генерация уникальных имен файлов
- Автоматическое создание уникальных имен для загружаемых файлов

### Мониторинг посетителей
- Отслеживание пользователей онлайн
- Определение типа посетителя (пользователь, гость, бот)
- Логирование посещений
- Статистика по поисковым ботам

### Защитные механизмы
- Блокировка спам-регистраций
- Ограничение множественных регистраций
- Отключение ненужных опций плагинов

## Установка и настройка

1. Загрузите плагин в директорию `/wp-content/plugins/`
2. Активируйте плагин через меню 'Плагины' в WordPress
3. Для блокировки доменов создайте файл `blocked-domains.txt` в корневой директории WordPress
4. Для цитат создайте файл `quotes.txt` в директории темы

## Требования

- WordPress 5.0+
- PHP 7.4+
- Поддержка JavaScript в браузере

## Безопасность

Все функции реализованы с учетом рекомендаций по безопасности WordPress:
- Санитизация и валидация данных
- Экранирование вывода
- Использование WordPress API
- Защита от SQL-инъекций

## Производительность

Плагин оптимизирован для минимального влияния на производительность:
- Кэширование часто используемых данных
- Ленивая загрузка ресурсов
- Оптимизированные запросы к базе данных
- Очистка неиспользуемых данных

## Поддержка

Для получения поддержки посетите: https://github.com/RobertoBennett/anti-func

### Версия: 3.0.7
- Автор: Robert Bennett